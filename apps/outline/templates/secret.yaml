{{- $postgresPassword := randAlphaNum 32 }}
{{- $postgresUsername := randAlphaNum 12 }}
apiVersion: v1
kind: Secret
metadata:
  name: database
  annotations:
    "helm.sh/resource-policy": "keep"
type: Opaque
data:
  POSTGRES_USER: {{ $postgresUsername | b64enc | quote }}
  POSTGRES_PASSWORD: {{ $postgresPassword | b64enc | quote }}
  DATABASE_URL: {{ printf "postgres://%s:%s@postgres.default.svc.cluster.local:5432/%s" $postgresUsername $postgresPassword $postgresUsername | b64enc | quote }}
